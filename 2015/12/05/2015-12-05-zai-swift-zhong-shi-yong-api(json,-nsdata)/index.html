<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>在 Swift 中使用 API（JSON、NSData） | let Frank1ee = Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="这是一篇关于在 Swift 下通过 API 获取数据的学习笔记，如有错误纰漏欢迎评论指出，感谢。">
<meta property="og:type" content="article">
<meta property="og:title" content="在 Swift 中使用 API（JSON、NSData）">
<meta property="og:url" content="http://yoursite.com/2015/12/05/2015-12-05-zai-swift-zhong-shi-yong-api(json,-nsdata)/index.html">
<meta property="og:site_name" content="let Frank1ee = Builder">
<meta property="og:description" content="这是一篇关于在 Swift 下通过 API 获取数据的学习笔记，如有错误纰漏欢迎评论指出，感谢。">
<meta property="og:image" content="http://yoursite.com/images/petition.png">
<meta property="og:updated_time" content="2015-12-06T02:39:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="在 Swift 中使用 API（JSON、NSData）">
<meta name="twitter:description" content="这是一篇关于在 Swift 下通过 API 获取数据的学习笔记，如有错误纰漏欢迎评论指出，感谢。">
  
    <link rel="alternative" href="/atom.xml" title="let Frank1ee = Builder" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Frank Lee</a></h1>
		</hgroup>

		
		<p class="header-subtitle">记录自己的学习与见闻。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>標籤</li>
						
						<li>友情链接</li>
						
						
						<li>關於</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Frank Lee</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="null" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Frank Lee</h1>
			</hgroup>
			
			<p class="header-subtitle">记录自己的学习与见闻。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-2015-12-05-zai-swift-zhong-shi-yong-api(json,-nsdata)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/05/2015-12-05-zai-swift-zhong-shi-yong-api(json,-nsdata)/" class="article-date">
  	<time datetime="2015-12-05T03:17:38.000Z" itemprop="datePublished">2015-12-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      在 Swift 中使用 API（JSON、NSData）
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这是一篇关于在 Swift 下通过 API 获取数据的学习笔记，如有错误纰漏欢迎评论指出，感谢。<br><a id="more"></a></p>
<p>##什么是API？<br>记得刚开始学习iOS开发时就接触过这个字眼，遂 Google 得到以下解释：</p>
<blockquote>
<p>应用程序接口（英语：Application Programming Interface，简称：API），又称为应用编程接口，就是软件系统不同组成部分衔接的约定。由于近年来软件的规模日益庞大，常常需要把复杂的系统划分成小的组成部分，编程接口的设计十分重要。程序设计的实践中，编程接口的设计首先要使软件系统的职责得到合理划分。良好的接口设计可以降低系统各部分的相互依赖，提高组成单元的内聚性，降低组成单元间的耦合程度，从而提高系统的维护性和扩展性。- 摘自维基百科</p>
</blockquote>
<p>毫无疑问看得一知半解。简而言之，API的用途就是接入数据的通道，比如你想开发一个读书类的 App，需要图书信息资源，这时候就可以找到豆瓣提供的 API 来接入获取数据。</p>
<p>##通过平台提供的 API 获取 JSON<br>这里拿白宫的<a href="https://petitions.whitehouse.gov/developers" target="_blank" rel="external">请愿书</a> API 为例，通过提供的 API 请求到下方的 JSON 数据（示例）。JSON，可以理解为一种描述数据的文本格式，</p>
<p>-&gt;<img src="/images/petition.png" alt="alt text">&lt;-</p>
<p>##SwiftyJSON<br><a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="external">SwiftyJSON</a>是一个可以让解析 JSON 数据变得异常方便的第三方库，详细内容可以点击转跳到 Github 页查看。</p>
<p>##确认状态<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过平台提供的 API 链接创建一个 String</span></span><br><span class="line"> <span class="keyword">let</span> urlString = <span class="string">"https://api.whitehouse.gov/v1/petitions.json?limit=100"</span></span><br><span class="line"><span class="comment">//创建 NSData 对象</span></span><br><span class="line">   <span class="keyword">if</span> <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: urlString) &#123;</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> data = <span class="keyword">try</span>? <span class="type">NSData</span>(contentsOfURL: url, options: []) &#123;</span><br><span class="line">      <span class="comment">//导入SwiftyJSON，传入NSData 创建 JSON 对象</span></span><br><span class="line">         <span class="keyword">let</span> json = <span class="type">JSON</span>(data: data)</span><br><span class="line"><span class="comment">//通过 SwiftyJSON 便利地「一层层剥开」拿到数据</span></span><br><span class="line">  <span class="keyword">if</span> json[<span class="string">"metadata"</span>][<span class="string">"responseInfo"</span>][<span class="string">"status"</span>].intValue == <span class="number">200</span> &#123;</span><br><span class="line">            <span class="comment">// 确认状态后就可以开始解析JSON</span></span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><br>获取状态指的是解析 JSON 拿到”status”的值，当 status 的值为”200”时，意为「一切正常」。根据白宫请愿开发者页面所示，例如服务器异常引发的获取失败，那么 status 的值将会是”599”，从而可以让我们对不同的情况做出不同的响应。</p>
<p>##获取数据<br>上面「确认状态」的片段其实已经涉及到了获取数据。我们可以查看平台提供的JSON返回数据实例来了解各个数据的嵌套方式和各个数据的「title」，方便我们获取数据：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"metadata"</span>: &#123;</span><br><span class="line">    <span class="string">"responseInfo"</span>: &#123;</span><br><span class="line">      <span class="string">"status"</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="string">"developerMessage"</span>: <span class="string">"OK"</span>,</span><br><span class="line">      <span class="string">"userMessage"</span>: <span class="string">""</span>,</span><br><span class="line">      <span class="string">"errorCode"</span>: <span class="string">""</span>,</span><br><span class="line">      <span class="string">"moreInfo"</span>: <span class="string">""</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"requestInfo"</span>: &#123;</span><br><span class="line">      <span class="string">"apiVersion"</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">"resource"</span>: <span class="string">"petitions"</span>,</span><br><span class="line">      <span class="string">"query"</span>: &#123;</span><br><span class="line">        <span class="string">"body"</span>: null,</span><br><span class="line">        <span class="string">"createdAfter"</span>: null,</span><br><span class="line">        <span class="string">"createdAt"</span>: null,</span><br><span class="line">        <span class="string">"createdBefore"</span>: <span class="string">"1352924535"</span>,</span><br><span class="line">        <span class="string">"isPublic"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"isSignable"</span>: null,</span><br><span class="line">        <span class="string">"limit"</span>: <span class="string">"3"</span>,</span><br><span class="line">        <span class="string">"mock"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"offset"</span>: <span class="string">"0"</span>,</span><br><span class="line">        <span class="string">"petitionsDefaultLimit"</span>: <span class="number">1000</span>,</span><br><span class="line">        <span class="string">"publicThreshold"</span>: <span class="number">149</span>,</span><br><span class="line">        <span class="string">"responseId"</span>: null,</span><br><span class="line">        <span class="string">"signatureCount"</span>: null,</span><br><span class="line">        <span class="string">"signatureCountCeiling"</span>: null,</span><br><span class="line">        <span class="string">"signatureCountFloor"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"signatureThreshold"</span>: null,</span><br><span class="line">        <span class="string">"signatureThresholdCeiling"</span>: null,</span><br><span class="line">        <span class="string">"signatureThresholdFloor"</span>: null,</span><br><span class="line">        <span class="string">"status"</span>: null,</span><br><span class="line">        <span class="string">"title"</span>: null,</span><br><span class="line">        <span class="string">"url"</span>: null,</span><br><span class="line">        <span class="string">"websiteUrl"</span>: <span class="string">"https://petitions.whitehouse.gov"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"resultset"</span>: &#123;</span><br><span class="line">      <span class="string">"count"</span>: <span class="number">809</span>,</span><br><span class="line">      <span class="string">"limit"</span>: <span class="number">3</span>,</span><br><span class="line">      <span class="string">"offset"</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"results"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"id"</span>: <span class="string">"226511"</span>,</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"petition"</span>,</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"Ban the practice of circumcising individuals under the age of 18."</span>,</span><br><span class="line">      <span class="string">"body"</span>: <span class="string">"Circumcision is a barbaric tribal practice that amounts to child abuse. Before any individual under go any permanent body modification such as tattooing or sex reassignment surgery they must be considered old enough to understand the consequences. You cannot understand the ramifications of this act to your physical being until after puberty, when your genitals have fully developed. "</span>,</span><br><span class="line">      <span class="string">"issues"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">4</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Civil Rights and Liberties"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">25</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Health Care"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">28</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Human Rights"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"signatureThreshold"</span>: <span class="number">25000</span>,</span><br><span class="line">      <span class="string">"signatureCount"</span>: <span class="number">3085</span>,</span><br><span class="line">      <span class="string">"signaturesNeeded"</span>: <span class="number">21915</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"https://petitions.whitehouse.gov/petition/ban-practice-circumcising-individuals-under-age-18"</span>,</span><br><span class="line">      <span class="string">"deadline"</span>: <span class="number">1355512735</span>,</span><br><span class="line">      <span class="string">"status"</span>: <span class="string">"closed"</span>,</span><br><span class="line">      <span class="string">"response"</span>: [</span><br><span class="line"></span><br><span class="line">   ],</span><br><span class="line">      <span class="string">"created"</span>: <span class="number">1352920735</span>,</span><br><span class="line">      <span class="string">"isSignable"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"isPublic"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"id"</span>: <span class="string">"224306"</span>,</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"petition"</span>,</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"Remove HEMP (Non-Psychoactive Cannabis) from the Federal governments banned substance list. Make it Legal to Grow in USA"</span>,</span><br><span class="line">      <span class="string">"body"</span>: <span class="string">"There is no reason for it to be illegal. It won't make you high. It is Not Marijuana, and it alone could make enough oil to free the nation. Hemp is the most versatile plant in the Universe, its strong enough to make rope, and diverse enough to make oil. This plant will grow almost everywhere with very little maintenance and without watering.And it is insect resistant naturally. It grows quickly and the steps to turn it into gasoline are very simple. We could replace our need for anything other than hemp in a matter of Months, not years.\r\n\r\nFuel:\r\n\r\n* Hemp can produce 10 times more methanol than corn. \r\n* Hemp is Earth's number-one biomass resource; it is capable of producing 10 tons per acre in four months.\r\n"</span>,</span><br><span class="line">      <span class="string">"issues"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Agriculture"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Budget and Taxes"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">20</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Environment"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"signatureThreshold"</span>: <span class="number">25000</span>,</span><br><span class="line">      <span class="string">"signatureCount"</span>: <span class="number">5091</span>,</span><br><span class="line">      <span class="string">"signaturesNeeded"</span>: <span class="number">19909</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"https://petitions.whitehouse.gov/petition/remove-hemp-non-psychoactive-cannabis-federal-governments-banned-substance-list-make-it"</span>,</span><br><span class="line">      <span class="string">"deadline"</span>: <span class="number">1355510348</span>,</span><br><span class="line">      <span class="string">"status"</span>: <span class="string">"closed"</span>,</span><br><span class="line">      <span class="string">"response"</span>: [</span><br><span class="line"></span><br><span class="line">   ],</span><br><span class="line">      <span class="string">"created"</span>: <span class="number">1352918348</span>,</span><br><span class="line">      <span class="string">"isSignable"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"isPublic"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"id"</span>: <span class="string">"224016"</span>,</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"petition"</span>,</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"Stop the US Diversity Immigrant Visa (Lottery) Program - \"The USA's Open Door Welfare Program\"..."</span>,</span><br><span class="line">      <span class="string">"body"</span>: <span class="string">"Millions of Americans don't realize what's going on in this country.\r\nAnyone can fill out an online application form, then \"WIN\" the right to come to this country and claim all the benefits. The LOTTERY makes available up to 55,000 diversity visas annually, drawn from random selection BY COMPUTER; they are just WINNING\" permanent resident status based on no qualifications!\r\nAs a result, government officials are admitting millions of immigrants each year who are dependent on Medicaid, child care benefits, foster care, energy assistance, education assistance, nutritional welfare programs and other medical and health benefits.\r\nWe cant afford for our government to promote a policy that encourages immigrants to apply for a green card Lottery and \"WIN\"- NOT DESERVE the right to become USA citizen!"</span>,</span><br><span class="line">      <span class="string">"issues"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="number">29</span>,</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"Immigration"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"signatureThreshold"</span>: <span class="number">25000</span>,</span><br><span class="line">      <span class="string">"signatureCount"</span>: <span class="number">2819</span>,</span><br><span class="line">      <span class="string">"signaturesNeeded"</span>: <span class="number">22181</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"https://petitions.whitehouse.gov/petition/stop-us-diversity-immigrant-visa-lottery-program-usas-open-door-welfare-program"</span>,</span><br><span class="line">      <span class="string">"deadline"</span>: <span class="number">1355509876</span>,</span><br><span class="line">      <span class="string">"status"</span>: <span class="string">"closed"</span>,</span><br><span class="line">      <span class="string">"response"</span>: [</span><br><span class="line"></span><br><span class="line">   ],</span><br><span class="line">      <span class="string">"created"</span>: <span class="number">1352917876</span>,</span><br><span class="line">      <span class="string">"isSignable"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"isPublic"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>刚刚我们想要”status”的数据，就通过 SwiftyJSON 的 json[“metadata”][“responseInfo”][“status”].intValue 「剥开」三层拿到数据的 int 值，而”result”数据与”metadata”平级，就可以这么拿到数据：json[“result”]。</p>
<p>根据这个 API 提供的数据，拿到请愿书的 title、body 等数据：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> result <span class="keyword">in</span> json[<span class="string">"results"</span>].arrayValue &#123;</span><br><span class="line">        <span class="keyword">let</span> title = result[<span class="string">"title"</span>].stringValue</span><br><span class="line">        <span class="keyword">let</span> body = result[<span class="string">"body"</span>].stringValue</span><br><span class="line">        <span class="keyword">let</span> sigs = result[<span class="string">"signatureCount"</span>].stringValue</span><br><span class="line">        <span class="keyword">let</span> obj = [<span class="string">"title"</span>: title, <span class="string">"body"</span>: body, <span class="string">"sigs"</span>: sigs]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>取得”result”数据的数组值并遍历每块”result”，进一步从中取出其他数据并根据 key 保存在字典中，这样我们就实现了从平台上获取数据啦。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2015/11/04/2015-11-04-<<ying-yu-mo-fa-shi->>-xue-xi-bi-ji/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">《英语魔法师》学习笔记（续更）</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="2015-12-05-zai-swift-zhong-shi-yong-api(json,-nsdata)" data-title="在 Swift 中使用 API（JSON、NSData）" data-url="http://yoursite.com/2015/12/05/2015-12-05-zai-swift-zhong-shi-yong-api(json,-nsdata)/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Frank Lee
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>